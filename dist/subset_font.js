var t=require("fs-extra"),m=require("os"),S=require("path");const[,,...F]=process.argv,a=F.includes("--minify"),w=require("subset-font"),f=process.platform==="win32",c={},O=(n=-1)=>{(0,t.writeJsonSync)(__filename+"on",c,{encoding:"utf8"}),n>-1&&process.exit(n)},T=a?async(n,o)=>{try{const i=await(0,t.readFile)(n.inp),s=["woff2","woff","sfnt"],l=s.length;for(let e=0;e<l;++e)try{const _=await w(i,o,{targetFormat:s[e]});n.out+=["woff2","woff","ttf"][e],await(0,t.outputFile)(n.out,_);break}catch{n.err+=`\u3010${s[e]} \u5909\u63DB\u5931\u6557\u3011
`;continue}}catch(i){n.err+=i.message+`
`}}:n=>(0,t.ensureLink)(n.inp,n.out),r=require("./font.json"),u=[],{username:p}=(0,m.userInfo)(),g="core/font",y=f?`C:/Users/${p}/AppData/Local/Microsoft/Windows/Fonts`:`/Users/${p}/Library/Fonts`,P=f?"C:/Windows/Fonts":"/Library/Fonts";for(const n in r){const o=String(r[n].inp).replace("::PATH_PRJ_FONTS::",g).replace("::PATH_USER_FONTS::",y).replace("::PATH_OS_FONTS::",P),i=`doc/prj/script/${n}${a?".":(0,S.extname)(o)}`,s=c[n]={inp:o,out:i,iSize:1,oSize:1,err:""};if(!(0,t.existsSync)(o)){s.err=`\u5909\u63DB\u5931\u6557\u3067\u3059\u3002\u5165\u529B\u30D5\u30A1\u30A4\u30EB ${r[n].inp.slice(20)} \u304C\u5B58\u5728\u3059\u308B\u304B\u78BA\u8A8D\u3057\u3066\u304F\u3060\u3055\u3044`;continue}u.push(T(s,r[n].txt))}Promise.allSettled(u).then(()=>{for(const n in c){const o=c[n],{inp:i,out:s}=o;if(o.inp=r[n].inp,!(0,t.existsSync)(s)){o.err+=`\u5909\u63DB\u5931\u6557\u3067\u3059\u3002\u51FA\u529B\u30D5\u30A1\u30A4\u30EB ${o.out} \u304C\u5B58\u5728\u3057\u307E\u305B\u3093`;continue}o.iSize=(0,t.statSync)(i).size,o.oSize=(0,t.statSync)(s).size}O(0)});
