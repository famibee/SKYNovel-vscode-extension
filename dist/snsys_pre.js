var D=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function H(e){return typeof e=="string"&&D.test(e)}var T=H;function L(e){if(!T(e))throw TypeError("Invalid UUID");var r,t=new Uint8Array(16);return t[0]=(r=parseInt(e.slice(0,8),16))>>>24,t[1]=r>>>16&255,t[2]=r>>>8&255,t[3]=r&255,t[4]=(r=parseInt(e.slice(9,13),16))>>>8,t[5]=r&255,t[6]=(r=parseInt(e.slice(14,18),16))>>>8,t[7]=r&255,t[8]=(r=parseInt(e.slice(19,23),16))>>>8,t[9]=r&255,t[10]=(r=parseInt(e.slice(24,36),16))/1099511627776&255,t[11]=r/4294967296&255,t[12]=r>>>24&255,t[13]=r>>>16&255,t[14]=r>>>8&255,t[15]=r&255,t}var C=L;var f=[];for(w=0;w<256;++w)f.push((w+256).toString(16).slice(1));var w;function E(e,r=0){return(f[e[r+0]]+f[e[r+1]]+f[e[r+2]]+f[e[r+3]]+"-"+f[e[r+4]]+f[e[r+5]]+"-"+f[e[r+6]]+f[e[r+7]]+"-"+f[e[r+8]]+f[e[r+9]]+"-"+f[e[r+10]]+f[e[r+11]]+f[e[r+12]]+f[e[r+13]]+f[e[r+14]]+f[e[r+15]]).toLowerCase()}function N(e){e=unescape(encodeURIComponent(e));for(var r=[],t=0;t<e.length;++t)r.push(e.charCodeAt(t));return r}var k="6ba7b810-9dad-11d1-80b4-00c04fd430c8",V="6ba7b811-9dad-11d1-80b4-00c04fd430c8";function U(e,r,t){function a(n,s,c,u){var x;if(typeof n=="string"&&(n=N(n)),typeof s=="string"&&(s=C(s)),((x=s)===null||x===void 0?void 0:x.length)!==16)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var o=new Uint8Array(16+n.length);if(o.set(s),o.set(n,s.length),o=t(o),o[6]=o[6]&15|r,o[8]=o[8]&63|128,c){u=u||0;for(var i=0;i<16;++i)c[u+i]=o[i];return c}return E(o)}try{a.name=e}catch{}return a.DNS=k,a.URL=V,a}function F(e,r,t,a){switch(e){case 0:return r&t^~r&a;case 1:return r^t^a;case 2:return r&t^r&a^t&a;case 3:return r^t^a}}function B(e,r){return e<<r|e>>>32-r}function G(e){var r=[1518500249,1859775393,2400959708,3395469782],t=[1732584193,4023233417,2562383102,271733878,3285377520];if(typeof e=="string"){var a=unescape(encodeURIComponent(e));e=[];for(var n=0;n<a.length;++n)e.push(a.charCodeAt(n))}else Array.isArray(e)||(e=Array.prototype.slice.call(e));e.push(128);for(var s=e.length/4+2,c=Math.ceil(s/16),u=new Array(c),x=0;x<c;++x){for(var o=new Uint32Array(16),i=0;i<16;++i)o[i]=e[x*64+i*4]<<24|e[x*64+i*4+1]<<16|e[x*64+i*4+2]<<8|e[x*64+i*4+3];u[x]=o}u[c-1][14]=(e.length-1)*8/Math.pow(2,32),u[c-1][14]=Math.floor(u[c-1][14]),u[c-1][15]=(e.length-1)*8&4294967295;for(var d=0;d<c;++d){for(var p=new Uint32Array(80),v=0;v<16;++v)p[v]=u[d][v];for(var l=16;l<80;++l)p[l]=B(p[l-3]^p[l-8]^p[l-14]^p[l-16],1);for(var h=t[0],m=t[1],y=t[2],g=t[3],b=t[4],A=0;A<80;++A){var S=Math.floor(A/20),R=B(h,5)+F(S,m,y,g)+b+r[S]+p[A]>>>0;b=g,g=y,y=B(m,30)>>>0,m=h,h=R}t[0]=t[0]+h>>>0,t[1]=t[1]+m>>>0,t[2]=t[2]+y>>>0,t[3]=t[3]+g>>>0,t[4]=t[4]+b>>>0}return[t[0]>>24&255,t[0]>>16&255,t[0]>>8&255,t[0]&255,t[1]>>24&255,t[1]>>16&255,t[1]>>8&255,t[1]&255,t[2]>>24&255,t[2]>>16&255,t[2]>>8&255,t[2]&255,t[3]>>24&255,t[3]>>16&255,t[3]>>8&255,t[3]&255,t[4]>>24&255,t[4]>>16&255,t[4]>>8&255,t[4]&255]}var K=G;var O=U("v5",80,K),P=O;function M(e){return new Uint8Array((e.match(/../g)??[]).map(r=>parseInt(r,16))).buffer}function X(e){return btoa(new Uint8Array(e).reduce((r,t)=>r+String.fromCharCode(t),""))}function $(e){return Uint8Array.from(atob(e),r=>r.charCodeAt(0))}var I=class{constructor(r,t){this.hPass=r;this.subtle=t;this.#e=JSON.stringify(this.hPass),this.#r={name:"AES-GCM",iv:M(r.iv)}}#e;#r;get strHPass(){return this.#e}#n(r){return this.subtle.digest("SHA-512",new TextEncoder().encode(r))}uuidv5(r){return P(r,this.hPass.pass)}async init(){let r=await this.subtle.importKey("raw",await this.#n(this.hPass.pass),"PBKDF2",!1,["deriveKey"]);this.#t=await this.subtle.deriveKey({name:"PBKDF2",hash:"SHA-512",iterations:this.hPass.ite,salt:M(this.hPass.salt)},r,{name:this.#r.name,length:256},!1,["encrypt","decrypt"])}#t;async encAb(r){return await this.subtle.encrypt(this.#r,this.#t,r)}async enc(r){return X(await this.encAb(new TextEncoder().encode(r)))}async decAb(r){return await this.subtle.decrypt(this.#r,this.#t,r)}async dec(r){return new TextDecoder().decode(await this.decAb($(r)))}};var{subtle:J}=crypto;async function ur(e){let r=e.tstDecryptInfo(),t=new I(r,J);await t.init(),e.setDec(async(n,s)=>a.test(n)?await t.dec(s):s);let a=/(^|\.)(sn|ssn|json|html?)$/;e.setDecAB(async n=>{let s=new DataView(n.slice(0,4)).getUint32(0,!0),c=n.slice(4,4+s),u=await t.decAb(c),x=new DataView(u.slice(1,2)).getUint8(0),o=u.slice(2),i=n.slice(4+s),d=await new Blob([o,i]).arrayBuffer();return{ext_num:x,ab:d}}),e.setEnc(n=>t.enc(n)),e.getStK(()=>r.stk),e.getHash(n=>t.uuidv5(n))}export{ur as init};
